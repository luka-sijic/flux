{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 13, "column": 0}, "map": {"version":3,"sources":["file:///Users/based/Documents/projects/websocket/frontend/src/app/ws/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useRef } from 'react';\n\ntype WSMessage = {\n  type: 'join' | 'chat' | 'users' | 'log' | 'ping';\n  user?: string;\n  content?: string;\n  users?: Record<string, string>;\n  log?: string[]\n};\n\nexport default function Home() {\n  const connection = useRef<WebSocket | null>(null);\n  const [username, setUsername] = useState<string>('');\n  const [inputValue, setInputValue] = useState<string>('');\n  const [messages, setMessages] = useState<WSMessage[]>([]);\n  const [log, setLog] = useState<string[]>([]);\n  const [users, setUsers] = useState<Record<string, string>>({});\n\n  useEffect(() => {\n    const socket = new WebSocket('ws://127.0.0.1:8080/ws');\n\n    socket.onopen = () => {\n      console.log('Connection opened');\n    };\n\n    socket.onmessage = (event) => {\n      const data = JSON.parse(event.data) as WSMessage;\n\n      switch (data.type) {\n        case 'log':\n          console.log(data);\n          setLog(data.log ?? []);\n        case 'users':\n          // data.users is string[] or undefined → default to []\n          setUsers(data.users ?? {});\n          break;\n\n        case 'chat':\n          // append the new WSMessage to our array\n          setMessages((prev) => [...prev, data]);\n          break;\n        case 'ping':\n          socket.send(JSON.stringify({ type: 'pong' }));\n          break;\n      }\n    };\n\n    connection.current = socket;\n    return () => {\n      socket.close();\n    };\n  }, []);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!connection.current || connection.current.readyState !== WebSocket.OPEN) {\n      console.error('WebSocket not open');\n      return;\n    }\n\n    // First submit uses inputValue as the username\n    if (!username) {\n      const name = inputValue.trim();\n      if (!name) return;\n      connection.current.send(JSON.stringify({ type: 'join', user: name }));\n      setUsername(name);\n      setInputValue('');\n      return;\n    }\n\n    // Afterwards, send chat messages\n    const content = inputValue.trim();\n    if (!content) return;\n    connection.current.send(\n      JSON.stringify({ type: 'chat', user: username, content })\n    );\n    setInputValue('');\n  };\n\n  return (\n    <div className=\"flex h-screen\">\n      {/* Chat Column */}\n      <div className=\"flex flex-col flex-1 p-4\">\n        <div className=\"flex-1 overflow-y-auto border rounded p-3 whitespace-pre-wrap bg-black text-white\">\n          {log.map((m, i) => (\n            <p key={i}>\n              {m}\n            </p>\n          ))}\n          {messages.map((m, i) => (\n            <p key={i}>\n              <strong>{m.user}:</strong> {m.content}\n            </p>\n          ))}\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"flex mt-4 space-x-2\">\n          <input\n            type=\"text\"\n            value={inputValue}\n            onChange={(e) => setInputValue(e.target.value)}\n            placeholder={username ? 'Send a message…' : 'Set your username…'}\n            className=\"flex-1 border rounded px-3 py-2 focus:outline-none focus:ring\"\n          />\n          <button\n            type=\"submit\"\n            className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition\"\n          >\n            {username ? 'Send' : 'Join'}\n          </button>\n        </form>\n      </div>\n\n      {/* Users Column */}\n      <div className=\"w-64 border-l p-4 bg-black\">\n        <h2 className=\"text-xl font-semibold mb-2\">Users</h2>\n        <ul className=\"space-y-1\">\n          {Object.entries(users).map(([key, value]) => (\n            <li key={key}>{key}: {value}</li>\n          ))}\n        </ul>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 216, "column": 0}, "map": {"version":3,"sources":["file:///Users/based/Documents/projects/websocket/frontend/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":"AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 237, "column": 0}, "map": {"version":3,"sources":["file:///Users/based/Documents/projects/websocket/frontend/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 244, "column": 0}, "map": {"version":3,"sources":["file:///Users/based/Documents/projects/websocket/frontend/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n"],"names":["module","exports","require","vendored","React"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK","ignoreList":[0],"debugId":null}}]
}