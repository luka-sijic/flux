{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 13, "column": 0}, "map": {"version":3,"sources":["file:///Users/based/Documents/projects/websocket/message/frontend/src/app/ws/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useRef } from \"react\";\nimport { Circle } from \"lucide-react\";\n\ntype WSMessage = {\n  type: \"join\" | \"chat\" | \"users\" | \"log\" | \"ping\";\n  user?: string;\n  content?: string;\n  users?: Record<string, string>;\n  log?: string[];\n};\n\nexport default function Home() {\n  const connection = useRef<WebSocket | null>(null);\n  const [username, setUsername] = useState<string>(\"\");\n  const [inputValue, setInputValue] = useState<string>(\"\");\n  const [messages, setMessages] = useState<WSMessage[]>([]);\n  const [log, setLog] = useState<string[]>([]);\n  const [users, setUsers] = useState<Record<string, string>>({});\n\n  useEffect(() => {\n    const socket = new WebSocket(\"ws://127.0.0.1:8080/ws\");\n\n    socket.onopen = () => {\n      console.log(\"Connection opened\");\n    };\n\n    socket.onmessage = (event) => {\n      const data = JSON.parse(event.data) as WSMessage;\n\n      switch (data.type) {\n        case \"log\":\n          console.log(data);\n          const byteLen = new TextEncoder().encode(JSON.stringify(data)).length;\n          console.log(\"Length: \" + byteLen);\n          setLog(data.log ?? []);\n        case \"users\":\n          // data.users is string[] or undefined → default to []\n          setUsers(data.users ?? {});\n          break;\n\n        case \"chat\":\n          // append the new WSMessage to our array\n          setMessages((prev) => [...prev, data]);\n          break;\n        case \"ping\":\n          socket.send(JSON.stringify({ type: \"pong\" }));\n          break;\n      }\n    };\n\n    connection.current = socket;\n    return () => {\n      socket.close();\n    };\n  }, []);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (\n      !connection.current ||\n      connection.current.readyState !== WebSocket.OPEN\n    ) {\n      console.error(\"WebSocket not open\");\n      return;\n    }\n\n    // First submit uses inputValue as the username\n    if (!username) {\n      const name = inputValue.trim();\n      if (!name) return;\n      connection.current.send(JSON.stringify({ type: \"join\", user: name }));\n      setUsername(name);\n      setInputValue(\"\");\n      return;\n    }\n\n    // Afterwards, send chat messages\n    const content = inputValue.trim();\n    if (content.length) if (!content) return;\n    connection.current.send(\n      JSON.stringify({ type: \"chat\", user: username, content })\n    );\n    setInputValue(\"\");\n  };\n\n  return (\n    <div className=\"flex flex-col h-screen overflow-x-hidden\">\n      {/* Chat Column */}\n      <div className=\"flex flex-col flex-1 p-4 min-h-0\">\n        {/* Messages: now fills full height and only scrolls vertically */}\n        <div\n          className=\"\n        flex-1                /* take up all remaining vertical space */\n        overflow-y-auto       /* vertical scrolling as needed */\n        overflow-x-hidden     /* hide any horizontal overflow */\n        border rounded p-3\n        whitespace-pre-wrap\n        break-words           /* wrap long words */\n        break-all             /* break really long tokens if needed */\n        bg-black text-white\n      \"\n        >\n          {log.map((m, i) => (\n            <p key={i}>{m}</p>\n          ))}\n          {messages.map((m, i) => (\n            <p key={i}>\n              <strong>{m.user}:</strong> {m.content}\n            </p>\n          ))}\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"flex mt-4 space-x-2\">\n          <input\n            type=\"text\"\n            value={inputValue}\n            onChange={(e) => setInputValue(e.target.value)}\n            placeholder={username ? \"Send a message…\" : \"Set your username…\"}\n            minLength={2}\n            maxLength={200}\n            required\n            className=\"flex-1 border rounded px-3 py-2 focus:outline-none focus:ring\"\n          />\n          <button\n            type=\"submit\"\n            className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition\"\n          >\n            {username ? \"Send\" : \"Join\"}\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AAFA;;;AAae,SAAS;IACtB,MAAM,aAAa,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAoB;IAC5C,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAU;IACjD,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAU;IACrD,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAe,EAAE;IACxD,MAAM,CAAC,KAAK,OAAO,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAY,EAAE;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAA0B,CAAC;IAE5D,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,SAAS,IAAI,UAAU;QAE7B,OAAO,MAAM,GAAG;YACd,QAAQ,GAAG,CAAC;QACd;QAEA,OAAO,SAAS,GAAG,CAAC;YAClB,MAAM,OAAO,KAAK,KAAK,CAAC,MAAM,IAAI;YAElC,OAAQ,KAAK,IAAI;gBACf,KAAK;oBACH,QAAQ,GAAG,CAAC;oBACZ,MAAM,UAAU,IAAI,cAAc,MAAM,CAAC,KAAK,SAAS,CAAC,OAAO,MAAM;oBACrE,QAAQ,GAAG,CAAC,aAAa;oBACzB,OAAO,KAAK,GAAG,IAAI,EAAE;gBACvB,KAAK;oBACH,sDAAsD;oBACtD,SAAS,KAAK,KAAK,IAAI,CAAC;oBACxB;gBAEF,KAAK;oBACH,wCAAwC;oBACxC,YAAY,CAAC,OAAS;+BAAI;4BAAM;yBAAK;oBACrC;gBACF,KAAK;oBACH,OAAO,IAAI,CAAC,KAAK,SAAS,CAAC;wBAAE,MAAM;oBAAO;oBAC1C;YACJ;QACF;QAEA,WAAW,OAAO,GAAG;QACrB,OAAO;YACL,OAAO,KAAK;QACd;IACF,GAAG,EAAE;IAEL,MAAM,eAAe,CAAC;QACpB,EAAE,cAAc;QAChB,IACE,CAAC,WAAW,OAAO,IACnB,WAAW,OAAO,CAAC,UAAU,KAAK,UAAU,IAAI,EAChD;YACA,QAAQ,KAAK,CAAC;YACd;QACF;QAEA,+CAA+C;QAC/C,IAAI,CAAC,UAAU;YACb,MAAM,OAAO,WAAW,IAAI;YAC5B,IAAI,CAAC,MAAM;YACX,WAAW,OAAO,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;gBAAE,MAAM;gBAAQ,MAAM;YAAK;YAClE,YAAY;YACZ,cAAc;YACd;QACF;QAEA,iCAAiC;QACjC,MAAM,UAAU,WAAW,IAAI;QAC/B,IAAI,QAAQ,MAAM,EAAE;YAAA,IAAI,CAAC,SAAS;QAAM;QACxC,WAAW,OAAO,CAAC,IAAI,CACrB,KAAK,SAAS,CAAC;YAAE,MAAM;YAAQ,MAAM;YAAU;QAAQ;QAEzD,cAAc;IAChB;IAEA,qBACE,8OAAC;QAAI,WAAU;kBAEb,cAAA,8OAAC;YAAI,WAAU;;8BAEb,8OAAC;oBACC,WAAU;;wBAWT,IAAI,GAAG,CAAC,CAAC,GAAG,kBACX,8OAAC;0CAAW;+BAAJ;;;;;wBAET,SAAS,GAAG,CAAC,CAAC,GAAG,kBAChB,8OAAC;;kDACC,8OAAC;;4CAAQ,EAAE,IAAI;4CAAC;;;;;;;oCAAU;oCAAE,EAAE,OAAO;;+BAD/B;;;;;;;;;;;8BAMZ,8OAAC;oBAAK,UAAU;oBAAc,WAAU;;sCACtC,8OAAC;4BACC,MAAK;4BACL,OAAO;4BACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;4BAC7C,aAAa,WAAW,oBAAoB;4BAC5C,WAAW;4BACX,WAAW;4BACX,QAAQ;4BACR,WAAU;;;;;;sCAEZ,8OAAC;4BACC,MAAK;4BACL,WAAU;sCAET,WAAW,SAAS;;;;;;;;;;;;;;;;;;;;;;;AAMjC","debugId":null}},
    {"offset": {"line": 186, "column": 0}, "map": {"version":3,"sources":["file:///Users/based/Documents/projects/websocket/message/frontend/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":"AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 207, "column": 0}, "map": {"version":3,"sources":["file:///Users/based/Documents/projects/websocket/message/frontend/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 214, "column": 0}, "map": {"version":3,"sources":["file:///Users/based/Documents/projects/websocket/message/frontend/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n"],"names":["module","exports","require","vendored","React"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK","ignoreList":[0],"debugId":null}}]
}