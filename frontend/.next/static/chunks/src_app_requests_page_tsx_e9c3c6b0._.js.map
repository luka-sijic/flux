{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/based/Documents/projects/websocket/message/frontend/src/app/requests/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState, FormEvent } from \"react\";\nimport axios from \"axios\";\nimport { useRouter } from \"next/navigation\";\nimport { Check, X } from \"lucide-react\";\nimport toast from 'react-hot-toast';\n\ntype Friends = {\n  friend: string;\n};\n\nexport default function Requests() {\n  const router = useRouter();\n  const [friends, setFriends] = useState<Friends[]>([]);\n  const [token, setToken] = useState<string>(\"\");\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    if (!token) return router.replace(\"/auth\");\n    setToken(token);\n  }, []);\n\n  useEffect(() => {\n    if (!token) return;\n    const fetchFriendReq = async () => {\n      const response = await axios.get(\"http://127.0.0.1:8081/friend\", {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n      });\n      console.log(response);\n      if (response.status === 200) {\n        setFriends(response.data);\n      }\n    };\n    fetchFriendReq();\n  }, [token]);\n\n  const friendResponse = async (e: FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    const action = (e.nativeEvent as SubmitEvent)\n      .submitter as HTMLButtonElement;\n\n    // collect the form fields\n    const form = e.currentTarget;\n    const data = new FormData(form);\n    data.set(\"action\", action.value);\n\n    const response = await axios.post(\n      \"http://127.0.0.1:8081/friend/respond\",\n      data,\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n      }\n    );\n    if (response.status === 200) {\n      setFriends((prev) => prev.filter(f => f.friend !== data.get('friendId')));\n    }\n  };\n\n  return (\n    <div>\n      <h2>Friend Requests</h2>\n      <div className=\"bg-gray-700 p-2 m-2 w-64 rounded\">\n        {\" \"}\n        {/* smaller box */}\n        <ul className=\"space-y-1\">\n          {\" \"}\n          {/* tiny gap between rows */}\n          {friends.length === 0 ? (\n            <p>No pending friend requests</p>\n          ) : (\n            friends.map((f, i) => (\n              <li key={i} className=\"flex items-center\">\n                <span className=\"truncate\">{f.friend}</span>{\" \"}\n                {/* name on the left */}\n                {/* icons on the far right, with space between them */}\n                <div className=\"ml-auto flex gap-3\">\n                  <form onSubmit={friendResponse}>\n                    <input type=\"hidden\" name=\"friendId\" value={f.friend} />\n                    <button value=\"accepted\">\n                      <Check className=\"cursor-pointer\" />\n                    </button>\n                    <button value=\"rejected\">\n                      <X className=\"cursor-pointer\" />\n                    </button>\n                  </form>\n                </div>\n              </li>\n            ))\n          )}\n        </ul>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AAAA;;;AALA;;;;;AAYe,SAAS;;IACtB,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAa,EAAE;IACpD,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU;IAE3C,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YACR,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,IAAI,CAAC,OAAO,OAAO,OAAO,OAAO,CAAC;YAClC,SAAS;QACX;6BAAG,EAAE;IAEL,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YACR,IAAI,CAAC,OAAO;YACZ,MAAM;qDAAiB;oBACrB,MAAM,WAAW,MAAM,wIAAA,CAAA,UAAK,CAAC,GAAG,CAAC,gCAAgC;wBAC/D,SAAS;4BACP,gBAAgB;4BAChB,eAAe,AAAC,UAAe,OAAN;wBAC3B;oBACF;oBACA,QAAQ,GAAG,CAAC;oBACZ,IAAI,SAAS,MAAM,KAAK,KAAK;wBAC3B,WAAW,SAAS,IAAI;oBAC1B;gBACF;;YACA;QACF;6BAAG;QAAC;KAAM;IAEV,MAAM,iBAAiB,OAAO;QAC5B,EAAE,cAAc;QAChB,MAAM,SAAS,AAAC,EAAE,WAAW,CAC1B,SAAS;QAEZ,0BAA0B;QAC1B,MAAM,OAAO,EAAE,aAAa;QAC5B,MAAM,OAAO,IAAI,SAAS;QAC1B,KAAK,GAAG,CAAC,UAAU,OAAO,KAAK;QAE/B,MAAM,WAAW,MAAM,wIAAA,CAAA,UAAK,CAAC,IAAI,CAC/B,wCACA,MACA;YACE,SAAS;gBACP,gBAAgB;gBAChB,eAAe,AAAC,UAAe,OAAN;YAC3B;QACF;QAEF,IAAI,SAAS,MAAM,KAAK,KAAK;YAC3B,WAAW,CAAC,OAAS,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,KAAK,KAAK,GAAG,CAAC;QAC9D;IACF;IAEA,qBACE,6LAAC;;0BACC,6LAAC;0BAAG;;;;;;0BACJ,6LAAC;gBAAI,WAAU;;oBACZ;kCAED,6LAAC;wBAAG,WAAU;;4BACX;4BAEA,QAAQ,MAAM,KAAK,kBAClB,6LAAC;0CAAE;;;;;uCAEH,QAAQ,GAAG,CAAC,CAAC,GAAG,kBACd,6LAAC;oCAAW,WAAU;;sDACpB,6LAAC;4CAAK,WAAU;sDAAY,EAAE,MAAM;;;;;;wCAAS;sDAG7C,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC;gDAAK,UAAU;;kEACd,6LAAC;wDAAM,MAAK;wDAAS,MAAK;wDAAW,OAAO,EAAE,MAAM;;;;;;kEACpD,6LAAC;wDAAO,OAAM;kEACZ,cAAA,6LAAC,uMAAA,CAAA,QAAK;4DAAC,WAAU;;;;;;;;;;;kEAEnB,6LAAC;wDAAO,OAAM;kEACZ,cAAA,6LAAC,+LAAA,CAAA,IAAC;4DAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;mCAXZ;;;;;;;;;;;;;;;;;;;;;;;AAsBvB;GAxFwB;;QACP,qIAAA,CAAA,YAAS;;;KADF","debugId":null}}]
}